(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["Threelet"] = factory();
	else
		root["Threelet"] = factory();
})(typeof self !== 'undefined' ? self : this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/regenerator-runtime/runtime.js":
/*!*****************************************************!*\
  !*** ./node_modules/regenerator-runtime/runtime.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration. If the Promise is rejected, however, the\n          // result for this iteration will be rejected with the same\n          // reason. Note that rejections of yielded Promises are not\n          // thrown back into the generator function, as is the case\n          // when an awaited Promise is rejected. This difference in\n          // behavior between yield and await is important, because it\n          // allows the consumer to decide what to do with the yielded\n          // rejection (swallow it and continue, manually .throw it back\n          // into the generator, abandon iteration, whatever). With\n          // await, by contrast, there is no opportunity to examine the\n          // rejection reason outside the generator function, so the\n          // only option is to throw it from the await expression, and\n          // let the generator function handle the exception.\n          result.value = unwrapped;\n          resolve(result);\n        }, reject);\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // In sloppy mode, unbound `this` refers to the global object, fallback to\n  // Function constructor if we're in global strict mode. That is sadly a form\n  // of indirect eval which violates Content Security Policy.\n  (function() { return this })() || Function(\"return this\")()\n);\n\n\n//# sourceURL=webpack://Threelet/./node_modules/regenerator-runtime/runtime.js?");

/***/ }),

/***/ "./src/SkyHelper.js":
/*!**************************!*\
  !*** ./src/SkyHelper.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// credits: SkyHelper is based on the sky example -\n// https://github.com/mrdoob/three.js/blob/master/examples/webgl_shaders_sky.html\nvar SkyHelper = function () {\n    function SkyHelper(classSky) {\n        _classCallCheck(this, SkyHelper);\n\n        this._classSky = classSky;\n        this._effectController = {\n            turbidity: 10,\n            rayleigh: 2,\n            mieCoefficient: 0.005,\n            mieDirectionalG: 0.8,\n            luminance: 1,\n            inclination: 0.49, // elevation / inclination\n            azimuth: 0.25, // Facing front,\n            sun: !true\n        };\n        this._updateUniforms = null;\n    }\n\n    _createClass(SkyHelper, [{\n        key: \"init\",\n        value: function init() {\n            var _this = this;\n\n            // Add Sky\n            var sky = new this._classSky();\n            sky.scale.setScalar(450000);\n            // scene.add( sky );\n            // Add Sun Helper\n            var sunSphere = new THREE.Mesh(new THREE.SphereBufferGeometry(20000, 16, 8), new THREE.MeshBasicMaterial({ color: 0xffffff }));\n            sunSphere.position.y = -700000;\n            sunSphere.visible = false;\n            // scene.add( sunSphere );\n            /// GUI\n            var distance = 400000;\n\n            // function guiChanged() {\n            //-------\n            this._updateUniforms = function () {\n                var effectController = _this._effectController;\n\n                var uniforms = sky.material.uniforms;\n                uniforms[\"turbidity\"].value = effectController.turbidity;\n                uniforms[\"rayleigh\"].value = effectController.rayleigh;\n                uniforms[\"luminance\"].value = effectController.luminance;\n                uniforms[\"mieCoefficient\"].value = effectController.mieCoefficient;\n                uniforms[\"mieDirectionalG\"].value = effectController.mieDirectionalG;\n                var theta = Math.PI * (effectController.inclination - 0.5);\n                var phi = 2 * Math.PI * (effectController.azimuth - 0.5);\n                sunSphere.position.x = distance * Math.cos(phi);\n                sunSphere.position.y = distance * Math.sin(phi) * Math.sin(theta);\n                sunSphere.position.z = distance * Math.sin(phi) * Math.cos(theta);\n                sunSphere.visible = effectController.sun;\n                uniforms[\"sunPosition\"].value.copy(sunSphere.position);\n                // renderer.render( scene, camera );\n            };\n\n            // var gui = new dat.GUI();\n            // gui.add( effectController, \"turbidity\", 1.0, 20.0, 0.1 ).onChange( guiChanged );\n            // gui.add( effectController, \"rayleigh\", 0.0, 4, 0.001 ).onChange( guiChanged );\n            // gui.add( effectController, \"mieCoefficient\", 0.0, 0.1, 0.001 ).onChange( guiChanged );\n            // gui.add( effectController, \"mieDirectionalG\", 0.0, 1, 0.001 ).onChange( guiChanged );\n            // gui.add( effectController, \"luminance\", 0.0, 2 ).onChange( guiChanged );\n            // gui.add( effectController, \"inclination\", 0, 1, 0.0001 ).onChange( guiChanged );\n            // gui.add( effectController, \"azimuth\", 0, 1, 0.0001 ).onChange( guiChanged );\n            // gui.add( effectController, \"sun\" ).onChange( guiChanged );\n            // guiChanged();\n            //--------\n            this._updateUniforms(); // first time\n            return [sky, sunSphere];\n        }\n    }, {\n        key: \"updateUniforms\",\n        value: function updateUniforms() {\n            var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            if (!this._updateUniforms) {\n                throw 'updateUniforms(): error; init() must be called first';\n            }\n            Object.assign(this._effectController, params);\n            this._updateUniforms();\n        }\n    }]);\n\n    return SkyHelper;\n}();\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (SkyHelper);\n\n//# sourceURL=webpack://Threelet/./src/SkyHelper.js?");

/***/ }),

/***/ "./src/Utils.js":
/*!**********************!*\
  !*** ./src/Utils.js ***!
  \**********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// TODO to be more categorically organized in future\n\nvar Logger = function () {\n    function Logger() {\n        var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n        _classCallCheck(this, Logger);\n\n        var defaults = {\n            mute: true\n        };\n        var actual = Object.assign({}, defaults, opts);\n        this._mute = actual.mute;\n\n        this.times = [];\n        this.splits = [];\n        this.arg0s = [];\n\n        this._last = performance.now() / 1000;\n    }\n\n    _createClass(Logger, [{\n        key: 'log',\n        value: function log() {\n            var now = performance.now() / 1000;\n            var splits = now - this._last;\n            this.times.push(now);\n            this.splits.push(splits);\n\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            this.arg0s.push(args[0]);\n\n            this._last = now;\n            if (!this._mute) {\n                Logger._consoleLog.apply(Logger, ['==== ' + now.toFixed(3) + ' +' + splits.toFixed(3) + ' ===='].concat(args));\n            }\n        }\n    }, {\n        key: 'grep',\n        value: function grep(query) {\n            var _this = this;\n\n            var idxs = this.arg0s.reduce(function (acc, val, idx) {\n                if (typeof val !== 'string') {\n                    Logger._consoleLog('grep(): warning: not a string');\n                    return acc;\n                } else if (val.includes(query)) {\n                    acc.push(idx);\n                }\n                return acc;\n            }, []);\n            // console.log('idxs:', idxs);\n\n            return {\n                times: idxs.map(function (i) {\n                    return _this.times[i];\n                }),\n                splits: idxs.map(function (i) {\n                    return _this.splits[i];\n                }),\n                arg0s: idxs.map(function (i) {\n                    return _this.arg0s[i];\n                })\n            };\n        }\n    }], [{\n        key: '_consoleLog',\n        value: function _consoleLog() {\n            // for eluding uglify\n            var _console = console;\n\n            for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                args[_key2] = arguments[_key2];\n            }\n\n            _console.log.apply(_console, args);\n        }\n    }]);\n\n    return Logger;\n}();\n\nvar Utils = function () {\n    function Utils() {\n        _classCallCheck(this, Utils);\n    }\n\n    _createClass(Utils, null, [{\n        key: 'createLineBox',\n\n        //======== begin test obj utils ========\n        value: function createLineBox(dim) {\n            var color = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0xcccccc;\n\n            return new THREE.LineSegments(new THREE.EdgesGeometry(new (Function.prototype.bind.apply(THREE.BoxBufferGeometry, [null].concat(_toConsumableArray(dim))))()), new THREE.LineBasicMaterial({ color: color }));\n        }\n    }, {\n        key: 'createTestHemisphereLight',\n        value: function createTestHemisphereLight() {\n            return new THREE.HemisphereLight(0x808080, 0x606060);\n        }\n    }, {\n        key: 'createTestDirectionalLight',\n        value: function createTestDirectionalLight() {\n            var light = new THREE.DirectionalLight(0xffffff);\n            light.position.set(0, 6, 0);\n            light.castShadow = true;\n            light.shadow.camera.top = 2;\n            light.shadow.camera.bottom = -2;\n            light.shadow.camera.right = 2;\n            light.shadow.camera.left = -2;\n            light.shadow.mapSize.set(4096, 4096);\n            return light;\n        }\n    }, {\n        key: 'createTestObjects',\n        value: function createTestObjects() {\n            var offset = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [0, 1, -2];\n\n            var objs = [];\n            var geoms = [new THREE.BoxBufferGeometry(0.2, 0.2, 0.2), new THREE.ConeBufferGeometry(0.2, 0.2, 64), new THREE.CylinderBufferGeometry(0.2, 0.2, 0.2, 64), new THREE.IcosahedronBufferGeometry(0.2, 3), new THREE.TorusBufferGeometry(0.2, 0.04, 64, 32)];\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = geoms[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var geom = _step.value;\n\n                    var object = new THREE.Mesh(geom, new THREE.MeshStandardMaterial({\n                        color: Math.random() * 0xffffff,\n                        roughness: 0.7,\n                        metalness: 0.0\n                    }));\n                    object.position.set(2 * Math.random() - 1 + offset[0], 2 * Math.random() - 1 + offset[1], 2 * Math.random() - 1 + offset[2]);\n                    object.rotation.x = Math.random() * 2 * Math.PI;\n                    object.rotation.y = Math.random() * 2 * Math.PI;\n                    object.rotation.z = Math.random() * 2 * Math.PI;\n                    object.scale.setScalar(Math.random() + 0.5);\n                    object.castShadow = true;\n                    object.receiveShadow = true;\n                    objs.push(object);\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n\n            return objs;\n        }\n    }, {\n        key: 'createTestCube',\n        value: function createTestCube() {\n            var size = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [0.4, 0.1, 0.4];\n            var color = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0xff00ff;\n            var wireframe = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n            var cube = new THREE.Mesh(new (Function.prototype.bind.apply(THREE.BoxGeometry, [null].concat(_toConsumableArray(size))))(), new THREE.MeshBasicMaterial({\n                color: color,\n                wireframe: wireframe\n            }));\n            cube.position.set(0, 0.5, -1.5);\n            return cube;\n        }\n        //======== end test obj utils ========\n\n        //======== begin 3D model utils ========\n\n        // <script src=\"../deps/ColladaLoader.js\"></script>\n\n    }, {\n        key: 'loadCollada',\n        value: function loadCollada(path) {\n            var cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n            // https://github.com/mrdoob/three.js/blob/master/examples/webgl_loader_collada_skinning.html\n            var loader = new THREE.ColladaLoader();\n            var filter = function filter(collada) {\n                var object = collada.scene;\n                console.log('@@ object:', object);\n                object.traverse(function (node) {\n                    // console.log('@@ node:', node);\n                    // console.log('@@ node.type:', node.type);\n                    if (node.isSkinnedMesh) {\n                        node.frustumCulled = false;\n                        // node.material.wireframe = true; // @@ debug\n                    }\n                });\n                return [object, collada];\n            };\n            return Utils.fetchModelData(loader, path, filter, cb);\n        }\n\n        // <script src=\"../deps/inflate.min.js\"></script>\n        // <script src=\"../deps/FBXLoader.js\"></script>\n\n    }, {\n        key: 'loadFBX',\n        value: function loadFBX(path) {\n            var cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n            // https://github.com/mrdoob/three.js/blob/master/examples/webgl_loader_fbx.html\n            var loader = new THREE.FBXLoader();\n            var filter = function filter(object) {\n                console.log('@@ object:', object);\n                object.traverse(function (node) {\n                    if (node.isMesh) {\n                        node.castShadow = true;\n                        node.receiveShadow = true;\n                    }\n                });\n                return [object, object];\n            };\n            return Utils.fetchModelData(loader, path, filter, cb);\n        }\n\n        // <script src=\"../deps/GLTFLoader.js\"></script>\n\n    }, {\n        key: 'loadGLTF',\n        value: function loadGLTF(path, file) {\n            var cb = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n            var loader = new THREE.GLTFLoader().setPath(path);\n            var filter = function filter(gltf) {\n                console.log('@@ gltf:', gltf);\n                var object = gltf.scene;\n                object.traverse(function (node) {\n                    // if (node.isMesh) {\n                    //     node.material.envMap = envMap;\n                    // }\n                });\n                return [object, gltf];\n            };\n            return Utils.fetchModelData(loader, file, filter, cb);\n        }\n\n        // filter: raw => [object, raw]\n\n    }, {\n        key: 'fetchModelData',\n        value: function fetchModelData(loader, file, filter) {\n            var cb = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n            var cbError = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n\n            // e.g. https://threejs.org/docs/#examples/loaders/GLTFLoader\n            var _doLoad = function _doLoad(url, onSuccess, onError) {\n                var onProgress = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n                loader.load(url, function (raw) {\n                    return onSuccess(Utils._resolveAnimations.apply(Utils, _toConsumableArray(filter(raw))));\n                }, onProgress, // (xhr) => {}\n                onError); // (error) => {}\n            };\n\n            // not using onProgress\n            return Utils._cbOrPromise(_doLoad, file, cb, cbError);\n        }\n\n        // https://github.com/mrdoob/three.js/blob/master/examples/webgl_loader_gltf_extensions.html\n        // https://threejs.org/docs/manual/en/introduction/Animation-system.html\n\n    }, {\n        key: '_resolveAnimations',\n        value: function _resolveAnimations(object, raw) {\n            var animations = raw.animations;\n            var mixer = null;\n            var actions = [];\n            if (animations && animations.length) {\n                mixer = new THREE.AnimationMixer(object);\n                var _iteratorNormalCompletion2 = true;\n                var _didIteratorError2 = false;\n                var _iteratorError2 = undefined;\n\n                try {\n                    for (var _iterator2 = animations[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                        var anim = _step2.value;\n\n                        actions.push(mixer.clipAction(anim).play());\n                    }\n                } catch (err) {\n                    _didIteratorError2 = true;\n                    _iteratorError2 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                            _iterator2.return();\n                        }\n                    } finally {\n                        if (_didIteratorError2) {\n                            throw _iteratorError2;\n                        }\n                    }\n                }\n            }\n            console.log('@@ actions:', actions);\n            return { // modelData\n                object: object,\n                mixer: mixer,\n                actions: actions,\n                raw: raw\n            };\n        }\n\n        //======== end 3D model utils ========\n\n        //======== begin composition utils ========\n\n    }, {\n        key: 'createDataFlipY',\n        value: function createDataFlipY(data, shape) {\n            var _shape = _slicedToArray(shape, 3),\n                w = _shape[0],\n                h = _shape[1],\n                size = _shape[2];\n\n            var out = new Uint8Array(data.length);\n            for (var y = 0; y < h; y++) {\n                for (var x = 0; x < w * size; x += size) {\n                    for (var i = 0; i < size; i++) {\n                        out[(h - 1 - y) * w * size + x + i] = data[y * w * size + x + i];\n                    }\n                }\n            }\n            return out;\n        }\n    }, {\n        key: '_cbOrPromise',\n        value: function _cbOrPromise(f, arg0, cb, cbError) {\n            return cb ? f(arg0, cb, cbError) : new Promise(function (res, rej) {\n                return f(arg0, res, rej);\n            });\n        }\n    }, {\n        key: 'createCanvasFromImage',\n        value: function createCanvasFromImage(src) {\n            var cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n            var cbError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n            var _doLoad = function _doLoad(_src, onSuccess, onError) {\n                var img = new Image();\n                img.onload = function () {\n                    var can = document.createElement('canvas');\n                    can.width = img.width;\n                    can.height = img.height;\n                    can.getContext('2d').drawImage(img, 0, 0, img.width, img.height);\n                    onSuccess(can);\n                };\n                img.onerror = function (event) {\n                    return onError ? onError(event) : null;\n                };\n                img.src = _src;\n            };\n            return Utils._cbOrPromise(_doLoad, src, cb, cbError);\n        }\n    }, {\n        key: 'createCanvasFromText',\n        value: function createCanvasFromText(text, width, height) {\n            var opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n            var defaults = {\n                bg: \"#fff\",\n                tbg: \"#fff\",\n                tfg: \"#000\",\n                fontSize: \"13px\",\n                // fontFamily: \"Times\",\n                fontFamily: \"monospace\", // https://stackoverflow.com/questions/4686754/making-every-character-on-a-web-page-the-same-width\n                offset: [25, 35]\n            };\n            var actual = Object.assign({}, defaults, opts);\n\n            var can = document.createElement(\"canvas\");\n            can.width = width;\n            can.height = height;\n\n            var ctx = can.getContext(\"2d\");\n            ctx.textAlign = \"left\";\n            ctx.textBaseline = \"middle\";\n\n            text = text.replace(/&lt;/g, \"<\").replace(/&gt;/g, \">\").replace(/&quot;/, \"\\\"\");\n            var w = ctx.measureText(text).width + 16,\n                h = 45;\n\n            // ctx.font = `48px ${actual.fontFamily}`;\n            // ctx.font = `36px ${actual.fontFamily}`;\n\n            ctx.font = actual.fontSize + ' ' + actual.fontFamily;\n\n            ctx.fillStyle = actual.bg;\n            ctx.fillRect(0, 0, can.width, can.height);\n\n            ctx.fillStyle = actual.tbg;\n            ctx.fillRect(0, 0, w, 45);\n\n            ctx.fillStyle = actual.tfg;\n            // ctx.fillText(text, 25, 35+25); // ok for 256, 128\n            // ctx.fillText(text, 25, 35); // ok for 256, 64\n            ctx.fillText.apply(ctx, [text].concat(_toConsumableArray(actual.offset)));\n\n            return can;\n        }\n\n        // https://threejs.org/docs/#api/en/geometries/PlaneGeometry\n\n    }, {\n        key: 'createCanvasPlane',\n        value: function createCanvasPlane(can) {\n            var width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n            var height = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n            var widthSegments = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n            var heightSegments = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n\n            var geom = new THREE.PlaneGeometry(width, height, widthSegments, heightSegments);\n            var mat = new THREE.MeshBasicMaterial({\n                map: new THREE.Texture(can),\n                // color: 0xffff00,\n                side: THREE.DoubleSide });\n            mat.map.needsUpdate = true;\n            return new THREE.Mesh(geom, mat);\n        }\n    }, {\n        key: 'createCanvasSprite',\n        value: function createCanvasSprite(can) {\n            var pixelsPerUnit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 512;\n\n            return Utils._createSprite([can.width, can.height], // shape\n            new THREE.Texture(can), // map\n            pixelsPerUnit);\n        }\n    }, {\n        key: 'createDataSprite',\n        value: function createDataSprite(texData, shape) {\n            var pixelsPerUnit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 512;\n\n            return Utils._createSprite(shape, new THREE.DataTexture(texData, shape[0], shape[1], THREE.RGBAFormat), pixelsPerUnit);\n        }\n    }, {\n        key: '_createSprite',\n        value: function _createSprite(shape, map, pixelsPerUnit) {\n            var mat = new THREE.SpriteMaterial({\n                map: map,\n                // opacity: 0.7,\n                color: 0xffffff\n            });\n            mat.map.needsUpdate = true;\n            var sp = new THREE.Sprite(mat);\n            sp.scale.set(shape[0] / pixelsPerUnit, shape[1] / pixelsPerUnit, 1.0);\n            return sp;\n        }\n    }, {\n        key: 'pixelsToMesh',\n        value: function pixelsToMesh(pixels) {\n            var positions = [];\n            var colors = [];\n\n            // positions.push(0,0,0,  0.5,0,0,  0,0.5,0);\n            // colors.push(0,255,0,100,  0,255,0,100,  0,255,0,100);\n            //----\n            var x = 0,\n                y = pixels.shape[1] - 1,\n                z = 0;\n            for (var e = 0; e < pixels.data.length; e += 4) {\n                var _ref = [pixels.data[e], pixels.data[e + 1], pixels.data[e + 2], pixels.data[e + 3]],\n                    r = _ref[0],\n                    g = _ref[1],\n                    b = _ref[2],\n                    a = _ref[3];\n\n                colors.push(r, g, b, a, r, g, b, a, r, g, b, a);\n                z = (r + g + b) / (255 * 3) * 0.01; // \"normalized\" intensity x maxThickness\n                positions.push(x / 1000, y / 1000, z, x / 1000 + 0.001, y / 1000, z, x / 1000, y / 1000 + 0.001, z);\n                x++;\n                if (x === pixels.shape[0]) {\n                    // wrap\n                    x = 0;\n                    y--;\n                }\n            }\n\n            // console.log('positions:', positions);\n            // console.log('colors:', colors);\n            return this.vertsToMesh(positions, colors);\n        }\n    }, {\n        key: 'vertsToMesh',\n        value: function vertsToMesh(positions, colors) {\n            var colorAttribute = new THREE.Uint8BufferAttribute(colors, 4); // note: \"dupe\" the colors array\n            colorAttribute.normalized = true; // map to 0.0f - +1.0f in the shader\n            var geometry = new THREE.BufferGeometry();\n            geometry.addAttribute('position', new THREE.Float32BufferAttribute(positions, 3)); // note: \"dupe\" the positions array\n            geometry.addAttribute('color', colorAttribute);\n            var vs = '\\n            precision mediump float;\\n            precision mediump int;\\n            uniform mat4 modelViewMatrix; // optional\\n            uniform mat4 projectionMatrix; // optional\\n            attribute vec3 position;\\n            attribute vec4 color;\\n            varying vec3 vPosition;\\n            varying vec4 vColor;\\n            void main()\\t{\\n                vPosition = position;\\n                vColor = color;\\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n            }\\n        ';\n            var fs = '\\n            precision mediump float;\\n            precision mediump int;\\n            uniform float time;\\n            varying vec3 vPosition;\\n            varying vec4 vColor;\\n            void main()\\t{\\n                vec4 color = vec4( vColor );\\n                //color.r += sin( vPosition.x * 10.0 + time ) * 0.5;\\n                gl_FragColor = color;\\n            }\\n        ';\n            var uni = {\n                time: { value: 1.0 }\n            };\n            var material = new THREE.RawShaderMaterial({\n                uniforms: uni,\n                vertexShader: vs,\n                fragmentShader: fs,\n                side: THREE.DoubleSide,\n                transparent: true\n            });\n            var mesh = new THREE.Mesh(geometry, material);\n            return {\n                mesh: mesh,\n                uniforms: uni\n            };\n        }\n    }, {\n        key: 'createBufferGeometryMesh',\n        value: function createBufferGeometryMesh(positions, colors) {\n            var scale = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1.0;\n\n            var mesh = this.vertsToMesh(positions, colors).mesh;\n            mesh.geometry.scale(scale, scale, scale);\n            return mesh;\n        }\n\n        //======== end composition utils ========\n\n        //======== begin misc utils ========\n\n    }, {\n        key: 'downloadDataURL',\n        value: function downloadDataURL(dataURL, filename) {\n            var a = document.createElement('a');\n            a.href = dataURL;\n            a.download = filename;\n            a.style.display = 'none';\n            document.body.appendChild(a);\n            a.click();\n            a.remove();\n        }\n    }, {\n        key: 'formatDate',\n        value: function formatDate(date) {\n            var format = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'YYYY-MM-DD-hh.mm.ss';\n\n            format = format.replace(/YYYY/g, date.getFullYear());\n            format = format.replace(/MM/g, ('0' + (date.getMonth() + 1)).slice(-2));\n            format = format.replace(/DD/g, ('0' + date.getDate()).slice(-2));\n            format = format.replace(/hh/g, ('0' + date.getHours()).slice(-2));\n            format = format.replace(/mm/g, ('0' + date.getMinutes()).slice(-2));\n            format = format.replace(/ss/g, ('0' + date.getSeconds()).slice(-2));\n            return format;\n        }\n    }, {\n        key: 'capture',\n        value: function capture(canvas) {\n            var _this2 = this;\n\n            // test; 1x1 green png\n            // const extension = \"png\";\n            // const data = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==\";\n            //========\n            var extension = 1 ? 'jpg' : undefined;\n\n            var data = extension === 'jpg' ? canvas.toDataURL('image/jpeg', 0.8) : canvas.toDataURL('image/png'); // equivalent to .toDataURL()\n\n            var div = document.createElement('div');\n            var divMenu = document.createElement('div');\n            var img = document.createElement('img');\n            // img.width = 100; // only for the 1x1 test data\n            // img.height = 80; // only for the 1x1 test data\n            img.src = data;\n\n            var input = document.createElement('input');\n            input.style['width'] = \"320px\";\n            input.style['margin-left'] = \"8px\";\n            input.type = 'text';\n            input.value = 'capture-' + this.formatDate(new Date());\n\n            var spanExtension = document.createElement('span');\n            spanExtension.textContent = '.' + extension;\n\n            var btn = document.createElement('button');\n            btn.textContent = 'Save As';\n            // FIXME ?? not triggered on safari-iphone5\n            btn.onclick = function () {\n                _this2.downloadDataURL(data, input.value + '.' + extension);\n            };\n\n            div.appendChild(divMenu);\n            divMenu.appendChild(btn);\n            divMenu.appendChild(input);\n            divMenu.appendChild(spanExtension);\n            divMenu.appendChild(document.createElement('hr'));\n            div.appendChild(img);\n\n            // https://stackoverflow.com/questions/46666559/base64-image-open-in-new-tab-window-is-not-allowed-to-navigate-top-frame-naviga\n            var newTab = window.open();\n            // newTab.document.body.innerHTML = `<img src=\"${data}\" width=\"100px\" height=\"100px\">`; // ok\n            try {\n                newTab.document.body.appendChild(div);\n            } catch (e) {\n                console.log('ie !!!!????', e);\n                // https://stackoverflow.com/questions/36504016/appendchild-datauri-image-to-window-open-failing-in-ie\n                newTab.document.body.innerHTML = div.outerHTML;\n                // FIXME: onclick of btn not triggered...\n            }\n        }\n    }, {\n        key: 'loadWasmBindgen',\n        value: function loadWasmBindgen(name, jsImports) {\n            var _this3 = this;\n\n            return new Promise(function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(res, rej) {\n                    var response, buffer, obj;\n                    return regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                            switch (_context.prev = _context.next) {\n                                case 0:\n                                    _context.prev = 0;\n                                    _context.next = 3;\n                                    return fetch(name + '_bg.wasm');\n\n                                case 3:\n                                    response = _context.sent;\n                                    _context.next = 6;\n                                    return response.arrayBuffer();\n\n                                case 6:\n                                    buffer = _context.sent;\n                                    _context.next = 9;\n                                    return WebAssembly.instantiate(buffer, _defineProperty({}, name + '.js', jsImports));\n\n                                case 9:\n                                    obj = _context.sent;\n\n                                    Object.assign(jsImports.wasm, obj.instance.exports);\n                                    res(jsImports);\n                                    _context.next = 17;\n                                    break;\n\n                                case 14:\n                                    _context.prev = 14;\n                                    _context.t0 = _context['catch'](0);\n\n                                    rej(_context.t0);\n\n                                case 17:\n                                case 'end':\n                                    return _context.stop();\n                            }\n                        }\n                    }, _callee, _this3, [[0, 14]]);\n                }));\n\n                return function (_x24, _x25) {\n                    return _ref2.apply(this, arguments);\n                };\n            }());\n        }\n    }, {\n        key: 'createLogger',\n        value: function createLogger(opts) {\n            return new Logger(opts);\n        }\n        //======== end misc utils ========\n\n    }]);\n\n    return Utils;\n}();\n\nUtils.Logger = Logger;\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Utils);\n\n//# sourceURL=webpack://Threelet/./src/Utils.js?");

/***/ }),

/***/ "./src/VRControlHelper.js":
/*!********************************!*\
  !*** ./src/VRControlHelper.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// credits: VRControlHelper is based on the dragging example -\n// https://github.com/mrdoob/three.js/blob/master/examples/webvr_dragging.html\nvar VRControlHelper = function () {\n    function VRControlHelper(renderer) {\n        _classCallCheck(this, VRControlHelper);\n\n        // this.controllerArmLength = 0;\n        this.controllerArmLength = 0.25;\n        this.controllerLineLength = 5;\n\n        this.tempMatrix = new THREE.Matrix4();\n        this.raycaster = new THREE.Raycaster();\n        this.intersected = [];\n\n        this.group = new THREE.Group();\n\n        this.controllers = this._createControllers(renderer);\n        this.controllersState = {\n            touchpads: [],\n            triggers: [],\n            poses: [],\n            ids: []\n        };\n\n        this._eventListeners = {};\n    }\n\n    _createClass(VRControlHelper, [{\n        key: 'getInteractiveGroup',\n        value: function getInteractiveGroup() {\n            return this.group;\n        }\n    }, {\n        key: 'getControllers',\n        value: function getControllers() {\n            return this.controllers;\n        }\n    }, {\n        key: 'getControllersState',\n        value: function getControllersState() {\n            return this.controllersState;\n        }\n    }, {\n        key: 'toggleTriggerPressVisibility',\n        value: function toggleTriggerPressVisibility(i, tf) {\n            this.controllers[i].getObjectByName('trigger-press').visible = tf;\n        }\n    }, {\n        key: 'toggleTouchpadPointVisibility',\n        value: function toggleTouchpadPointVisibility(i, type, tf) {\n            var obj = this.controllers[i].getObjectByName('touchpad-' + type);\n            obj.visible = tf;\n            if (tf === false) {\n                obj.position.z = 99999; // kludge: workaround flickering\n            }\n        }\n    }, {\n        key: 'updateTouchpadPoint',\n        value: function updateTouchpadPoint(i, type) {\n            var touchpad = this.controllersState.touchpads[i];\n            var obj = this.controllers[i].getObjectByName('touchpad-' + type);\n            obj.position.set(touchpad.axes0 * 0.025, 0.0125, touchpad.axes1 * 0.025 - this.controllerArmLength - 0.025);\n        }\n    }, {\n        key: '_createControllers',\n        value: function _createControllers(renderer) {\n            // maybe load a 3D model instead of the box\n            // https://github.com/mrdoob/three.js/blob/master/examples/webvr_paint.html\n            var walls = new THREE.LineSegments(new THREE.EdgesGeometry(new THREE.BoxBufferGeometry(0.05, 0.025, 0.1)), new THREE.LineBasicMaterial({ color: 0xcccccc }));\n            walls.position.set(0, 0, -this.controllerArmLength); // customize Z for \"arm\" length\n\n            var line = new THREE.Line(new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, -1)]), new THREE.LineBasicMaterial({ color: 0xcccccc }));\n            line.position.set(0, 0, -this.controllerArmLength);\n            line.name = 'controller-line';\n            line.scale.z = this.controllerLineLength - this.controllerArmLength;\n\n            var triggerLoop = new THREE.LineLoop(new THREE.CircleGeometry(0.0125, 64), new THREE.LineBasicMaterial({ color: 0xcccccc }));\n            triggerLoop.geometry.vertices.shift(); // remove the center vertex\n            triggerLoop.position.set(0, 0, -this.controllerArmLength - 0.05);\n\n            var triggerCircle = new THREE.Mesh(new THREE.CircleGeometry(0.0125, 64), new THREE.MeshBasicMaterial({ color: 0x00cccc }));\n            triggerCircle.position.set(0, 0, -this.controllerArmLength - 0.05);\n            triggerCircle.material.side = THREE.DoubleSide;\n            triggerCircle.visible = false;\n            triggerCircle.name = 'trigger-press';\n\n            var padLoop = new THREE.LineLoop(new THREE.CircleGeometry(0.025, 64), new THREE.LineBasicMaterial({ color: 0xcccccc }));\n            padLoop.geometry.vertices.shift(); // remove the center vertex\n            padLoop.position.set(0, 0.0125, -this.controllerArmLength - 0.025);\n            padLoop.rotation.x = Math.PI / 2;\n\n            var padLoopTouch = new THREE.LineLoop(new THREE.CircleGeometry(0.005, 64), new THREE.LineBasicMaterial({ color: 0x00cccc }));\n            padLoopTouch.geometry.vertices.shift(); // remove the center vertex\n            padLoopTouch.position.set(0, 0.0125, -this.controllerArmLength - 0.025);\n            padLoopTouch.rotation.x = Math.PI / 2;\n            padLoopTouch.visible = false;\n            padLoopTouch.name = 'touchpad-touch';\n\n            var padCircleTouch = new THREE.Mesh(new THREE.CircleGeometry(0.005, 64), new THREE.MeshBasicMaterial({ color: 0x00cccc }));\n            padCircleTouch.position.set(0, 0.0125, -this.controllerArmLength - 0.025);\n            padCircleTouch.rotation.x = Math.PI / 2;\n            padCircleTouch.material.side = THREE.DoubleSide;\n            padCircleTouch.visible = false;\n            padCircleTouch.name = 'touchpad-press';\n\n            // https://github.com/mrdoob/three.js/blob/master/examples/webvr_dragging.html\n            var controllers = [0, 1].map(function (i) {\n                return renderer.vr.getController(i).add(walls.clone()).add(line.clone()).add(triggerLoop.clone()).add(triggerCircle.clone()).add(padLoop.clone()).add(padLoopTouch.clone()).add(padCircleTouch.clone());\n            });\n            console.log('@@ controllers:', controllers);\n\n            if (0) {}\n\n            return controllers;\n        }\n    }, {\n        key: '_addSelectListener',\n        value: function _addSelectListener(eventName, listener) {\n            var _this = this;\n\n            this.controllers.forEach(function (cont) {\n                cont.addEventListener(eventName, listener.bind(_this));\n            });\n        }\n    }, {\n        key: 'enableDragInteractiveGroup',\n        value: function enableDragInteractiveGroup() {\n            this._addSelectListener('selectstart', this.onSelectStartDrag);\n            this._addSelectListener('selectend', this.onSelectEndDrag);\n        }\n    }, {\n        key: 'onSelectStartDrag',\n        value: function onSelectStartDrag(event) {\n            var controller = event.target;\n            var intersections = this.getIntersections(controller, false);\n            console.log('@@ onSelectStart(): intersections.length:', intersections.length);\n\n            if (intersections.length > 0) {\n                var intersection = intersections[0];\n\n                this.tempMatrix.getInverse(controller.matrixWorld);\n\n                var object = intersection.object;\n                object.matrix.premultiply(this.tempMatrix);\n                object.matrix.decompose(object.position, object.quaternion, object.scale);\n                if (object.material.emissive) {\n                    object.material.emissive.b = 1;\n                }\n                controller.add(object);\n\n                controller.userData.selected = object;\n            }\n        }\n    }, {\n        key: 'onSelectEndDrag',\n        value: function onSelectEndDrag(event) {\n            console.log('@@ onSelectEnd(): hi');\n            var controller = event.target;\n            if (controller.userData.selected !== undefined) {\n                var object = controller.userData.selected;\n                object.matrix.premultiply(controller.matrixWorld);\n                object.matrix.decompose(object.position, object.quaternion, object.scale);\n                if (object.material.emissive) {\n                    object.material.emissive.b = 0;\n                }\n                this.group.add(object);\n\n                controller.userData.selected = undefined;\n            }\n        }\n    }, {\n        key: 'getIntersections',\n        value: function getIntersections(controller) {\n            var recursive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n            // console.log('@@ getIntersections(): hi');\n            return this.raycastFromController(controller, this.group.children, recursive);\n        }\n    }, {\n        key: 'raycastFromController',\n        value: function raycastFromController(controller, objs) {\n            var recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n            this.tempMatrix.identity().extractRotation(controller.matrixWorld);\n            this.raycaster.ray.origin.setFromMatrixPosition(controller.matrixWorld);\n            this.raycaster.ray.direction.set(0, 0, -1).applyMatrix4(this.tempMatrix);\n            return this.raycaster.intersectObjects(objs, recursive);\n        }\n\n        // mod of findGamepad() of three.js r104\n\n    }, {\n        key: 'updateControllers',\n\n        // mod of updateControllers() of three.js r104\n        value: function updateControllers() {\n            var stat = this.controllersState;\n\n            for (var i = 0; i < this.controllers.length; i++) {\n                var controller = this.controllers[i];\n                var gamepad = VRControlHelper._findGamepad(i);\n                // console.log('@@ updateControllers(): i, gamepad:', i, gamepad);\n\n                if (gamepad === undefined || gamepad.pose === undefined || gamepad.pose === null) {\n                    // this controller seems lost; reset the state\n                    stat.triggers[i] = undefined;\n                    stat.touchpads[i] = undefined;\n                    stat.poses[i] = undefined;\n                    stat.ids[i] = undefined;\n                    return;\n                }\n\n                var buttonId = gamepad.id === 'Daydream Controller' ? 0 : 1; // for trigger\n                var buttonIdTouchpad = 0;\n\n                stat.poses[i] = gamepad.pose;\n                stat.ids[i] = gamepad.id;\n\n                if (0) { var _gamepad$buttons, b0, b1; }\n\n                //-------- begin touchpad handling --------\n                var touched = gamepad.buttons[buttonIdTouchpad].touched;\n                var pressed = gamepad.buttons[buttonIdTouchpad].pressed;\n                var axes0 = gamepad.axes[0];\n                var axes1 = gamepad.axes[1];\n\n                if (stat.touchpads[i] === undefined) {\n                    stat.touchpads[i] = {\n                        touched: false,\n                        pressed: false,\n                        axes0: 0,\n                        axes1: 0\n                    };\n                };\n                var touchpad = stat.touchpads[i];\n\n                if (touchpad.touched !== touched) {\n                    var func = touched === true ? this._eventListeners['vr-touchpad-touch-start'] : this._eventListeners['vr-touchpad-touch-end'];\n                    if (func) func(i, axes0, axes1);\n                }\n\n                if (touchpad.pressed !== pressed) {\n                    var _func = pressed === true ? this._eventListeners['vr-touchpad-press-start'] : this._eventListeners['vr-touchpad-press-end'];\n                    if (_func) _func(i, axes0, axes1);\n                }\n\n                // diff touchpad states done; record the new state now\n                touchpad.touched = touched;\n                touchpad.pressed = pressed;\n                touchpad.axes0 = axes0;\n                touchpad.axes1 = axes1;\n                //-------- end touchpad handling --------\n\n                var trigger = gamepad.buttons[buttonId].pressed;\n\n                if (stat.triggers[i] === undefined) stat.triggers[i] = false;\n\n                if (stat.triggers[i] !== trigger) {\n                    stat.triggers[i] = trigger;\n                    var _func2 = stat.triggers[i] === true ? this._eventListeners['vr-trigger-press-start'] : this._eventListeners['vr-trigger-press-end'];\n                    if (_func2) _func2(i);\n                }\n            }\n        }\n    }, {\n        key: 'intersectObjects',\n        value: function intersectObjects() {\n            this._cleanIntersected();\n            if (this.controllers[0]) {\n                this._intersectObjects(this.controllers[0]);\n            }\n            if (this.controllers[1]) {\n                this._intersectObjects(this.controllers[1]);\n            }\n        }\n    }, {\n        key: '_intersectObjects',\n        value: function _intersectObjects(controller) {\n            // console.log('@@ intersectObjects(): hi');\n            // Do not highlight when already selected\n            if (controller.userData.selected !== undefined) return;\n\n            var intersections = this.getIntersections(controller);\n            // console.log('@@ intersections:', intersections);\n\n            var line = controller.getObjectByName('controller-line');\n            if (intersections.length > 0) {\n                var intersection = intersections[0];\n                var object = intersection.object;\n                if (object.material.emissive) {\n                    object.material.emissive.r = 1;\n                }\n                this.intersected.push(object);\n                // console.log('@@ intersection.distance:', intersection.distance);\n                line.scale.z = intersection.distance - this.controllerArmLength;\n            } else {\n                line.scale.z = this.controllerLineLength - this.controllerArmLength;\n            }\n        }\n    }, {\n        key: '_cleanIntersected',\n        value: function _cleanIntersected() {\n            // console.log('@@ cleanIntersected(): hi');\n            while (this.intersected.length) {\n                var object = this.intersected.pop();\n                if (object.material.emissive) {\n                    object.material.emissive.r = 0;\n                }\n            }\n        }\n    }], [{\n        key: '_findGamepad',\n        value: function _findGamepad(id) {\n            var gamepads = navigator.getGamepads && navigator.getGamepads();\n            for (var i = 0, j = 0, l = gamepads.length; i < l; i++) {\n                var gamepad = gamepads[i];\n                if (gamepad && (gamepad.id === 'Daydream Controller' || gamepad.id === 'Gear VR Controller' || gamepad.id === 'Oculus Go Controller' || gamepad.id === 'OpenVR Gamepad' || gamepad.id.startsWith('Oculus Touch') || gamepad.id.startsWith('HTC Vive Focus') || gamepad.id.startsWith('Spatial Controller'))) {\n                    if (j === id) return gamepad;\n                    j++;\n                }\n            }\n        }\n    }]);\n\n    return VRControlHelper;\n}();\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (VRControlHelper);\n\n//# sourceURL=webpack://Threelet/./src/VRControlHelper.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! regenerator-runtime/runtime.js */ \"./node_modules/regenerator-runtime/runtime.js\");\n/* harmony import */ var regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _VRControlHelper_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VRControlHelper.js */ \"./src/VRControlHelper.js\");\n/* harmony import */ var _SkyHelper_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SkyHelper.js */ \"./src/SkyHelper.js\");\n/* harmony import */ var _Utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Utils.js */ \"./src/Utils.js\");\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Threelet - https://github.com/w3reality/threelet\n// VR app framework based on three.js (MIT License)\n\nvar __version = \"0.9.19dev\";\n\n\n\n\n\n\n\nvar Threelet = function () {\n    function Threelet(params) {\n        var _this = this;\n\n        _classCallCheck(this, Threelet);\n\n        this.version = __version;\n        _Utils_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Logger._consoleLog('Threelet ' + __version + ' with THREE r' + THREE.REVISION);\n\n        var defaults = {\n            canvas: null,\n            width: 480,\n            height: 320,\n            // ---- viewer options ----\n            optScene: null,\n            optAxes: true, // axes and a unit lattice\n            optCameraPosition: [0, 1, 2] // initial camera position in desktop mode\n        };\n        var actual = Object.assign({}, defaults, params);\n\n        // for setting width, height of canvas\n        var _applySizeStyle = function _applySizeStyle(_canvas, _params) {\n            Object.assign(_canvas.style, {\n                width: typeof _params.width === 'string' ? _params.width : _params.width + 'px',\n                height: typeof _params.height === 'string' ? _params.height : _params.height + 'px'\n            });\n        };\n\n        // create domElement in case canvas is not provided\n        this.domElement = null;\n        var canvas = actual.canvas;\n        if (!canvas) {\n            // <div style=\"display: inline-block; position: relative;\">\n            //     <canvas style=\"width: 480px; height: 320px;\"></canvas>\n            // </div>\n            canvas = document.createElement('canvas');\n            _applySizeStyle(canvas, actual);\n            var div = document.createElement('div');\n            Object.assign(div.style, {\n                display: 'inline-block',\n                position: 'relative'\n            });\n            div.appendChild(canvas);\n            this.domElement = div;\n        } else {\n            if (params.width !== undefined && params.height !== undefined) {\n                _applySizeStyle(canvas, params);\n            }\n        }\n        this.canvas = canvas;\n\n        // basics\n\n        var _Threelet$_initBasics = Threelet._initBasics(canvas, actual);\n\n        var _Threelet$_initBasics2 = _slicedToArray(_Threelet$_initBasics, 3);\n\n        this.scene = _Threelet$_initBasics2[0];\n        this.camera = _Threelet$_initBasics2[1];\n        this.renderer = _Threelet$_initBasics2[2];\n\n\n        this.resizeCanvas(true); // first time\n\n        // render function\n        this.render = function () {\n            var isPresenting = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n            // console.log('@@ render(): isPresenting:', isPresenting);\n            if (_this._stats) {\n                _this._stats.update();\n            }\n            if (!isPresenting) {\n                _this.resizeCanvas();\n            }\n            _this.renderer.render(_this.scene, _this.camera);\n        };\n\n        // events\n        this._eventListeners = {};\n        this._eventListenerNames = [\n        // TODO add keyboard events\n        'mouse-down', // alias of 'mouse-down-left'\n        'mouse-down-left', 'mouse-down-middle', 'mouse-down-right', 'mouse-move', 'mouse-up', 'mouse-click', // alias of 'mouse-click-left'\n        'mouse-click-left', 'mouse-click-middle', 'mouse-click-right', 'mouse-drag-end', 'pointer-down', 'pointer-move', 'pointer-up', 'pointer-click', 'pointer-drag-end', 'touch-start', 'touch-move', 'touch-end', 'touch-click', 'touch-drag-end', 'vr-touchpad-touch-start', 'vr-touchpad-touch-end', 'vr-touchpad-press-start', 'vr-touchpad-press-end', 'vr-trigger-press-start', 'vr-trigger-press-end'];\n\n        this._initTouchListeners(this.renderer.domElement);\n        this._initPointerListeners(this.renderer.domElement);\n\n        //======== FIXME ?? - Oculus Go's desktop mode, OrbitControls breaks mouse events...\n        this._initMouseListeners(this.renderer.domElement);\n        //======== approach below is this too hackish and still not sure how to trigger\n        // // kludge for mouse events and overlay;\n        // canvas.style.display = 'block'; // https://stackoverflow.com/questions/8600393/there-is-a-4px-gap-below-canvas-video-audio-elements-in-html5\n        //\n        //         mouse events for *both* overlay and canvas\n        // this._initMouseListeners(document.querySelector('#overlay'));\n        // <!-- https://stackoverflow.com/questions/5763911/placing-a-div-within-a-canvas -->\n        // <style>\n        //     #canvas-wrap { position:relative } /* Make this a positioned parent */\n        //     #overlay {\n        //         position: absolute;\n        //         top: 0px; left: 0px; width: 100%; height: 50%;\n        //         background-color: #88000088; /* debug */\n        //         /* pointer-events: none; */\n        //     }\n        // </style>\n        // <div id=\"canvas-wrap\">\n        //   <canvas id=\"canvas\" style=\"width: 100%; height: 100%;\"></canvas>\n        //   <div id=\"overlay\"></div>\n        // </div>\n\n        // raycasting\n        this._raycaster = new THREE.Raycaster();;\n\n        // rendering loop and scene logic update\n        this.clock = new THREE.Clock();\n        this.timeLast = this.clock.getElapsedTime();\n        this.iid = null;\n        this.update = null;\n\n        // plugin module table\n        this.modTable = {\n            'mod-controls': this._setupControls,\n            'mod-stats': this._setupStats,\n            'mod-webvr': this._setupWebVR,\n            'mod-sky': this._setupSky\n        };\n\n        // for controls module\n        this._controls = null;\n\n        // for stats module\n        this._stats = null;\n\n        // for sky module\n        this.skyHelper = null;\n\n        // for WebVR module\n        this.fpsDesktopLast = 0;\n        this._vrcHelper = new _VRControlHelper_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.renderer);\n        this.vrButton = null;\n        // https://stackoverflow.com/questions/49471653/in-three-js-while-using-webvr-how-do-i-move-the-camera-position\n        // this.dolly = new THREE.Group();\n        // this.dolly.add(this.camera);\n\n        // api\n        this.onCreate(params);\n    }\n\n    _createClass(Threelet, [{\n        key: 'onCreate',\n        value: function onCreate(params) {\n            this.render(); // _first _time\n        }\n\n        // note: onUpdate() is not called in case this.update is defined\n\n    }, {\n        key: 'onUpdate',\n        value: function onUpdate(t, dt) {\n            // nop by default\n        }\n    }, {\n        key: 'onDestroy',\n        value: function onDestroy() {}\n        // nop for the moment\n\n\n        // plugin module setup function\n\n    }, {\n        key: 'setup',\n        value: function setup(modTitle, Module) {\n            var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n            if (modTitle in this.modTable) {\n                return this.modTable[modTitle].bind(this)(Module, opts);\n            } else {\n                console.warn('setup(): unsupported module title:', modTitle);\n            }\n        }\n    }, {\n        key: '_setupControls',\n        value: function _setupControls(Module, opts) {\n            var _this2 = this;\n\n            this._controls = new Module(this.camera, this.renderer.domElement);\n            this._controls.addEventListener('change', this.render.bind(null, false));\n\n            Threelet.hasVrDisplay(function (tf) {\n                if (tf) {\n                    // KLUDGE - OrbitControl breaks _initMouseListeners() on Oculus Go\n                    console.warn('not enabling OrbitControls (although requested) on this browser with VR display.');\n                    _this2._controls.enabled = false; // https://stackoverflow.com/questions/20058579/threejs-disable-orbit-camera-while-using-transform-control\n                }\n            });\n\n            return this._controls;\n        }\n    }, {\n        key: '_setupStats',\n        value: function _setupStats(Module, opts) {\n            var defaults = {\n                panelType: 0, // 0: fps, 1: ms, 2: mb, 3+: custom\n                appendTo: this.domElement ? this.domElement : document.body\n            };\n            var actual = Object.assign({}, defaults, opts);\n\n            var stats = this._stats = new Module();\n            stats.showPanel(actual.panelType);\n            if (actual.appendTo !== document.body) {\n                stats.dom.style.position = 'absolute';\n            }\n            actual.appendTo.appendChild(stats.dom);\n            return this._stats;\n        }\n    }, {\n        key: 'getSkyHelper',\n        value: function getSkyHelper() {\n            return this.skyHelper;\n        }\n    }, {\n        key: '_setupSky',\n        value: function _setupSky(Module, opts) {\n            this.skyHelper = new _SkyHelper_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](Module);\n            // console.log('@@ this.skyHelper:', this.skyHelper);\n\n            var _skyHelper$init = this.skyHelper.init(),\n                _skyHelper$init2 = _slicedToArray(_skyHelper$init, 2),\n                sky = _skyHelper$init2[0],\n                sunSphere = _skyHelper$init2[1];\n\n            this.scene.add(sky, sunSphere);\n            this.skyHelper.updateUniforms({\n                //---- drawn\n                // turbidity: 1,\n                //---- yingyang\n                mieCoefficient: 0.01,\n                luminance: 1.185,\n                inclination: 0.2,\n                azimuth: 0.35\n                //----\n            });\n            return [sky, sunSphere];\n        }\n    }, {\n        key: 'setupVRControlHelperTest',\n        value: function setupVRControlHelperTest() {\n            this.scene.add(_Utils_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].createTestHemisphereLight());\n            this.scene.add(_Utils_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].createTestDirectionalLight());\n\n            this.enableInteractiveGroup('drag');\n            var group = this.getInteractiveGroup();\n            _Utils_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].createTestObjects([0, 0, 0]).forEach(function (obj) {\n                return group.add(obj);\n            });\n            this.scene.add(group);\n        }\n    }, {\n        key: 'getVRControlHelper',\n        value: function getVRControlHelper() {\n            // deprecated\n            console.warn('@@ getVRControlHelper(): i am deprecated!!');\n            return this._vrcHelper;\n        }\n    }, {\n        key: 'getInteractiveGroup',\n        value: function getInteractiveGroup() {\n            return this._vrcHelper.getInteractiveGroup();\n        }\n    }, {\n        key: 'enableInteractiveGroup',\n        value: function enableInteractiveGroup(mode) {\n            if (mode === 'drag') {\n                this._vrcHelper.enableDragInteractiveGroup();\n                // TODO disable interface ??\n            } else {\n                console.warn('@@ unsupported interactive mode:', mode);\n            }\n        }\n    }, {\n        key: 'getControllersState',\n        value: function getControllersState() {\n            return this._vrcHelper.getControllersState();\n        }\n    }, {\n        key: 'displayControllerEvent',\n        value: function displayControllerEvent(i, what, tf) {\n            // only for updating visibility\n            if (what === 'vr-trigger-press') {\n                this._vrcHelper.toggleTriggerPressVisibility(i, tf);\n            } else if (what === 'vr-touchpad-touch') {\n                this._vrcHelper.toggleTouchpadPointVisibility(i, 'touch', tf);\n            } else if (what === 'vr-touchpad-press') {\n                this._vrcHelper.toggleTouchpadPointVisibility(i, 'press', tf);\n            } else {\n                console.warn('@@ unsupported what:', what);\n            }\n        }\n    }, {\n        key: 'updateControllerTouchpad',\n        value: function updateControllerTouchpad(i, what) {\n            // only for updating the position based on the current axes values\n            if (what === 'vr-touchpad-touch') {\n                this._vrcHelper.updateTouchpadPoint(i, 'touch');\n            } else if (what === 'vr-touchpad-press') {\n                this._vrcHelper.updateTouchpadPoint(i, 'press');\n            } else {\n                console.warn('@@ unsupported what:', what);\n            }\n        }\n    }, {\n        key: '_setupWebVR',\n        value: function _setupWebVR(Module) {\n            var _this3 = this;\n\n            var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n            var defaults = {\n                appendTo: this.domElement ? this.domElement : document.body\n            };\n            var actual = Object.assign({}, defaults, opts);\n\n            Threelet.hasVrDisplay(function (tf) {\n                console.log('hasVrDisplay():', tf);\n                // https://threejs.org/docs/manual/en/introduction/How-to-create-VR-content.html\n                // note: do make sure vr.enabled === false when enabling OrbitControls, or they interfere badly\n                _this3.renderer.vr.enabled = tf;\n            });\n\n            var btn = this._createVRButton(Module);\n            actual.appendTo.appendChild(btn);\n            this.vrButton = btn;\n\n            if (Threelet.isVrSupported()) {\n                this._vrcHelper.getControllers().forEach(function (cont) {\n                    return _this3.scene.add(cont);\n                });\n            }\n        }\n    }, {\n        key: '_createVRButton',\n        value: function _createVRButton(classWebVR) {\n            var _this4 = this;\n\n            var btn = classWebVR.createButton(this.renderer);\n            btn.style.top = btn.style.bottom;\n            btn.style.bottom = '';\n            if (Threelet.isVrSupported()) {\n                btn.addEventListener('click', function (ev) {\n                    console.log('@@ btn.textContent:', btn.textContent);\n                    if (btn.textContent.startsWith('ENTER')) {\n                        _this4.enterVR(function () {\n                            // onError\n                            console.log('@@ device:', _this4.renderer.vr.getDevice());\n                            console.log('@@ controller:', _this4.renderer.vr.getController(0));\n                            // TODO (how to programmatically exit the VR session????)\n                            // this.updateLoop(this.fpsDesktopLast); // wanna call this after exiting the vr session...\n                        });\n                    }\n                });\n            }\n            return btn;\n        }\n    }, {\n        key: 'enterVR',\n        value: function enterVR() {\n            var _this5 = this;\n\n            var onError = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n            // try entering VR for at most tryCountMax * delay (ms)\n            var tryCountMax = 30,\n                delay = 400;\n            var tryCount = 0;\n            var _enterVR = function _enterVR() {\n                setTimeout(function () {\n                    tryCount++;\n                    if (_this5.renderer.vr.isPresenting()) {\n                        console.log('@@ transition to vr loop!! (tryCount: ' + tryCount + ')');\n                        _this5.updateLoop(-1);\n                    } else {\n                        console.log('@@ vr not ready after: ' + tryCount * delay + ' ms (tryCount: ' + tryCount + ')');\n                        if (tryCount < tryCountMax) {\n                            _enterVR(tryCountMax, delay); // try harder\n                        } else if (onError) {\n                            console.error('@@ enter vr failed!!');\n                            onError();\n                        }\n                    }\n                }, delay); // need some delay for this.renderer.vr.isPresenting() to become true\n            };\n\n            this.updateLoop(0); // first, make sure desktop loop is stopped\n            _enterVR(tryCountMax, delay);\n        }\n    }, {\n        key: 'updateMechanics',\n        value: function updateMechanics() {\n            // update for the scene logic\n            var time = this.clock.getElapsedTime();\n            var dt = time - this.timeLast;\n            this.timeLast = time;\n            (this.update ? this.update : this.onUpdate.bind(this))(time, dt);\n        }\n    }, {\n        key: 'updateLoop',\n        value: function updateLoop(fps) {\n            var _this6 = this;\n\n            if (this.iid !== null) {\n                // console.log('@@ updateLoop(): clearing interval:', this.iid);\n                clearInterval(this.iid);\n            }\n\n            if (fps === 0) {\n                return; // stop the loop\n            } else if (fps < 0) {\n                // start the vr loop\n                this.renderer.setAnimationLoop(function () {\n                    if (!_this6.renderer.vr.isPresenting()) {\n                        _this6.renderer.setAnimationLoop(null); // stop the vr loop\n                        console.log('@@ transition back to desktop');\n                        // console.log('fps last:', this.fpsDesktopLast);\n                        return _this6.updateLoop(_this6.fpsDesktopLast);\n                    }\n\n                    _this6.render(true);\n                    _this6.updateMechanics();\n                    _this6._vrcHelper.intersectObjects();\n                    _this6._vrcHelper.updateControllers();\n                });\n                return;\n            }\n\n            // FIXME for this naive dev version, not looping with rAF()...\n            this.fpsDesktopLast = fps;\n            this.iid = setInterval(function () {\n                _this6.render(); // make sure image dump is available; https://stackoverflow.com/questions/30628064/how-to-toggle-preservedrawingbuffer-in-three-js\n                _this6.updateMechanics();\n            }, 1000 / fps);\n            // console.log('@@ updateLoop(): new interval:', this.iid);\n        }\n    }, {\n        key: 'resizeCanvas',\n        value: function resizeCanvas() {\n            var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n            Threelet._resizeCanvasToDisplaySize(this.canvas, this.renderer, this.camera, force);\n        }\n\n        // https://stackoverflow.com/questions/29884485/threejs-canvas-size-based-on-container\n\n    }, {\n        key: 'setEventListener',\n\n\n        // deprecated; for compat only\n        value: function setEventListener(eventName, listener) {\n            this.on(eventName, listener);\n        }\n    }, {\n        key: 'on',\n        value: function on(eventName, listener) {\n            if (this._eventListenerNames.includes(eventName)) {\n                // aliases\n                if (eventName === 'mouse-down') eventName = 'mouse-down-left';\n                if (eventName === 'mouse-click') eventName = 'mouse-click-left';\n\n                var listeners = eventName.startsWith('vr-') ? this._vrcHelper._eventListeners : this._eventListeners;\n                listeners[eventName] = listener;\n            } else {\n                console.error('@@ on(): unsupported eventName:', eventName);\n            }\n        }\n    }, {\n        key: '_callIfDefined',\n        value: function _callIfDefined(name, coords) {\n            var fn = this._eventListeners[name];\n            if (fn) fn.apply(undefined, _toConsumableArray(coords));\n        }\n    }, {\n        key: '_initMouseListeners',\n        value: function _initMouseListeners(canvas) {\n            var _this7 = this;\n\n            // https://stackoverflow.com/questions/6042202/how-to-distinguish-mouse-click-and-drag\n            var isDragging = false;\n            canvas.addEventListener(\"mousedown\", function (e) {\n                isDragging = false;\n                var coords = Threelet.getInputCoords(e, canvas);\n                // console.log('@@ mouse down:', ...coords);\n                if (e.button === 0) {\n                    _this7._callIfDefined('mouse-down-left', coords);\n                } else if (e.button === 1) {\n                    _this7._callIfDefined('mouse-down-middle', coords);\n                } else if (e.button === 2) {\n                    _this7._callIfDefined('mouse-down-right', coords);\n                }\n            }, false);\n            canvas.addEventListener(\"mousemove\", function (e) {\n                isDragging = true;\n                var coords = Threelet.getInputCoords(e, canvas);\n                // console.log('@@ mouse move:', ...coords);\n                _this7._callIfDefined('mouse-move', coords);\n            }, false);\n            canvas.addEventListener(\"mouseup\", function (e) {\n                // console.log('e:', e);\n                var coords = Threelet.getInputCoords(e, canvas);\n\n                // console.log('@@ mouse up:', ...coords);\n                _this7._callIfDefined('mouse-up', coords);\n\n                if (isDragging) {\n                    // console.log(\"mouseup: drag\");\n                    _this7._callIfDefined('mouse-drag-end', coords);\n                } else {\n                    // console.log(\"mouseup: click\");\n                    if (e.button === 0) {\n                        // console.log('@@ mouse click left:', ...coords);\n                        _this7._callIfDefined('mouse-click-left', coords);\n                    } else if (e.button === 1) {\n                        _this7._callIfDefined('mouse-click-middle', coords);\n                    } else if (e.button === 2) {\n                        // console.log('@@ mouse click right:', ...coords);\n                        _this7._callIfDefined('mouse-click-right', coords);\n                    }\n                }\n            }, false);\n        }\n    }, {\n        key: '_initPointerListeners',\n        value: function _initPointerListeners(canvas) {\n            var _this8 = this;\n\n            var isDragging = false;\n            canvas.addEventListener(\"pointerdown\", function (e) {\n                isDragging = false;\n                var coords = Threelet.getInputCoords(e, canvas);\n                // console.log('@@ pointer down:', ...coords);\n                _this8._callIfDefined('pointer-down', coords);\n            }, false);\n            canvas.addEventListener(\"pointermove\", function (e) {\n                isDragging = true;\n                var coords = Threelet.getInputCoords(e, canvas);\n                // console.log('@@ pointer move:', ...coords);\n                _this8._callIfDefined('pointer-move', coords);\n            }, false);\n            canvas.addEventListener(\"pointerup\", function (e) {\n                var coords = Threelet.getInputCoords(e, canvas);\n\n                // console.log('@@ pointer up:', ...coords);\n                _this8._callIfDefined('pointer-up', coords);\n\n                if (isDragging) {\n                    console.log(\"pointerup: drag\");\n                    _this8._callIfDefined('pointer-drag-end', coords);\n                } else {\n                    console.log(\"pointerup: click\");\n                    _this8._callIfDefined('pointer-click', coords);\n                }\n            }, false);\n        }\n    }, {\n        key: '_initTouchListeners',\n        value: function _initTouchListeners(canvas) {\n            var _this9 = this;\n\n            var isDragging = false;\n            canvas.addEventListener(\"touchstart\", function (e) {\n                isDragging = false;\n                var coords = Threelet.getInputCoords(e, canvas);\n                // console.log('@@ touch start:', ...coords);\n                _this9._callIfDefined('touch-start', coords);\n            }, false);\n            canvas.addEventListener(\"touchmove\", function (e) {\n                isDragging = true;\n                var coords = Threelet.getInputCoords(e, canvas);\n                // console.log('@@ touch move:', ...coords);\n                _this9._callIfDefined('touch-move', coords);\n            }, false);\n            canvas.addEventListener(\"touchend\", function (e) {\n                var coords = Threelet.getInputCoords(e, canvas);\n\n                // console.log('@@ touch end:', ...coords);\n                _this9._callIfDefined('touch-end', coords);\n\n                if (isDragging) {\n                    console.log(\"touchup: drag\");\n                    _this9._callIfDefined('touch-drag-end', coords);\n                } else {\n                    console.log(\"touchup: click\");\n                    _this9._callIfDefined('touch-click', coords);\n                }\n            }, false);\n        }\n\n        // highlevel utils for binding input device events\n\n    }, {\n        key: 'setupMouseInterface',\n        value: function setupMouseInterface(cbs) {\n            this._setupInputInterface('mouse', cbs);\n        }\n    }, {\n        key: 'setupPointerInterface',\n        value: function setupPointerInterface(cbs) {\n            this._setupInputInterface('pointer', cbs);\n        }\n    }, {\n        key: 'setupTouchInterface',\n        value: function setupTouchInterface(cbs) {\n            this._setupInputInterface('touch', cbs);\n        }\n    }, {\n        key: '_setupInputInterface',\n        value: function _setupInputInterface(device, callbacks) {\n            var onClick = callbacks.onClick,\n                onDrag = callbacks.onDrag,\n                onDragStart = callbacks.onDragStart,\n                onDragEnd = callbacks.onDragEnd;\n\n            var _isDragging = false;\n\n            var downEventName = device + '-' + (device === 'touch' ? 'start' : 'down');\n            this.on(downEventName, function (mx, my) {\n                _isDragging = true;\n                // console.log('@@ ifce down:', device, mx, my);\n                if (onDragStart) onDragStart(mx, my);\n            });\n\n            this.on(device + '-move', function (mx, my) {\n                if (onDrag && _isDragging) onDrag(mx, my);\n            });\n            this.on(device + '-drag-end', function (mx, my) {\n                _isDragging = false;\n                // console.log('@@ ifce drag end:', device, mx, my);\n                if (onDragEnd) onDragEnd(mx, my);\n            });\n            this.on(device + '-click', function (mx, my) {\n                _isDragging = false;\n                // console.log('@@ ifce click:', device, mx, my);\n                if (onClick) onClick(mx, my);\n                if (onDragEnd) onDragEnd(mx, my);\n            });\n        }\n    }, {\n        key: '_raycast',\n        value: function _raycast(meshes, recursive, faceExclude) {\n            var isects = this._raycaster.intersectObjects(meshes, recursive);\n            if (faceExclude) {\n                for (var i = 0; i < isects.length; i++) {\n                    if (isects[i].face !== faceExclude) {\n                        return isects[i];\n                    }\n                }\n                return null;\n            }\n            return isects.length > 0 ? isects[0] : null;\n        }\n    }, {\n        key: '_raycastFromMouse',\n        value: function _raycastFromMouse(mx, my, width, height, cam, meshes) {\n            var recursive = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : false;\n\n            var mouse = new THREE.Vector2( // normalized (-1 to +1)\n            mx / width * 2 - 1, -(my / height) * 2 + 1);\n            // https://threejs.org/docs/#api/core/Raycaster\n            // update the picking ray with the camera and mouse position\n            this._raycaster.setFromCamera(mouse, cam);\n            return this._raycast(meshes, recursive, null);\n        }\n    }, {\n        key: 'raycast',\n        value: function raycast(origin, direction, meshes) {\n            var recursive = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n            var faceExclude = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n\n            this._raycaster.set(origin, direction);\n            return this._raycast(meshes, recursive, faceExclude);\n        }\n    }, {\n        key: 'raycastFromMouse',\n        value: function raycastFromMouse(mx, my, meshes) {\n            var recursive = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n            //---- NG: 2x when starting with Chrome's inspector mobile\n            // const {width, height} = this.renderer.domElement;\n            // const {width, height} = this.canvas;\n            //---- OK\n            var _canvas2 = this.canvas,\n                clientWidth = _canvas2.clientWidth,\n                clientHeight = _canvas2.clientHeight;\n\n\n            return this._raycastFromMouse(mx, my, clientWidth, clientHeight, this.camera, meshes, recursive);\n        }\n    }, {\n        key: 'raycastFromController',\n        value: function raycastFromController(i, meshes) {\n            var recursive = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n            return this._vrcHelper.raycastFromController(this._vrcHelper.getControllers()[i], meshes, recursive);\n        }\n    }, {\n        key: 'capture',\n        value: function capture() {\n            // Without this pre-rendering, on the Silk browser,\n            // the result is blacked out second time in successive captures.\n            // Also relevant to this -- https://stackoverflow.com/questions/30628064/how-to-toggle-preservedrawingbuffer-in-three-js\n            this.render();\n\n            _Utils_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].capture(this.renderer.domElement);\n        }\n    }, {\n        key: 'dispose',\n        value: function dispose() {\n            this.onDestroy();\n\n            this.updateLoop(0); // stop the loop\n            this.update = null;\n\n            if (this._controls) {\n                this._controls.dispose();\n                this._controls = null;\n            }\n\n            if (this._stats) {\n                this._stats.dom.remove();\n            }\n\n            if (this.vrButton) {\n                this.vrButton.remove();\n            }\n\n            // this also ensures releasing memory for objects freed by freeScene()\n            this.renderer.dispose();\n            this.renderer = null;\n\n            // recursively release child objects in the scene\n            Threelet.freeScene(this.scene);\n            this.scene = null;\n\n            this.camera = null;\n        }\n    }, {\n        key: 'clearScene',\n        value: function clearScene() {\n            var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            var defaults = {\n                needAxes: false\n            };\n            var actual = Object.assign({}, defaults, opts);\n\n            if (!this.scene) return;\n\n            // clear objs in the scene\n            this.renderer.dispose();\n            Threelet.freeScene(this.scene);\n\n            if (actual.needAxes) {\n                var _Threelet$createAxes = Threelet.createAxes(),\n                    walls = _Threelet$createAxes.walls,\n                    axes = _Threelet$createAxes.axes;\n\n                this.scene.add(walls, axes);\n            }\n        }\n    }], [{\n        key: 'hasVrDisplay',\n        value: function hasVrDisplay(cb) {\n            if (this.isVrSupported()) {\n                // Oculus Go -> true\n                // desktop-firefox -> false (displays.length === 0)\n                navigator.getVRDisplays().then(function (displays) {\n                    return cb(displays.length > 0);\n                }).catch(function () {\n                    return cb(false);\n                });\n            } else {\n                // desktop-chrome, desktop-safari\n                cb(false);\n            }\n        }\n    }, {\n        key: 'isVrSupported',\n        value: function isVrSupported() {\n            // https://github.com/mrdoob/three.js/blob/dev/examples/js/vr/WebVR.js\n            return 'getVRDisplays' in navigator;\n        }\n    }, {\n        key: '_initBasics',\n        value: function _initBasics(canvas, opts) {\n            var _camera$position;\n\n            var camera = new THREE.PerspectiveCamera(75, canvas.width / canvas.height, 0.001, 1000);\n            (_camera$position = camera.position).set.apply(_camera$position, _toConsumableArray(opts.optCameraPosition));\n            camera.up.set(0, 1, 0); // important for OrbitControls\n\n            var renderer = new THREE.WebGLRenderer({\n                // alpha: true,\n                canvas: canvas\n            });\n            renderer.setPixelRatio(window.devicePixelRatio);\n            console.log('renderer:', renderer);\n\n            // init basic objects --------\n            var scene = opts.optScene ? opts.optScene : new THREE.Scene();\n\n            if (opts.optAxes) {\n                var _createAxes = this.createAxes(),\n                    walls = _createAxes.walls,\n                    axes = _createAxes.axes;\n\n                scene.add(walls, axes);\n            }\n\n            return [scene, camera, renderer];\n        }\n    }, {\n        key: 'createAxes',\n        value: function createAxes() {\n            var walls = _Utils_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].createLineBox([1, 1, 1], 0xcccccc);\n            walls.position.set(0, 0, 0);\n            walls.name = 'walls';\n            var axes = new THREE.AxesHelper(1);\n            axes.name = 'axes';\n            return { walls: walls, axes: axes };\n        }\n    }, {\n        key: '_resizeCanvasToDisplaySize',\n        value: function _resizeCanvasToDisplaySize(canvas, renderer, camera) {\n            var force = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n            var width = canvas.clientWidth;\n            var height = canvas.clientHeight;\n\n            // adjust displayBuffer size to match\n            if (force || canvas.width != width || canvas.height != height) {\n                // you must pass false here or three.js sadly fights the browser\n                // console.log \"resizing: #{canvas.width} #{canvas.height} -> #{width} #{height}\"\n                renderer.setSize(width, height, false);\n                camera.aspect = width / height;\n                camera.updateProjectionMatrix();\n            }\n        }\n    }, {\n        key: 'getInputCoords',\n        value: function getInputCoords(e, canvas) {\n            // console.log('@@ e:', e, e.type);\n            // https://developer.mozilla.org/en-US/docs/Web/API/Touch/clientX\n            var x = void 0,\n                y = void 0;\n            if (e.type === 'touchend') {\n                var _ref = [e.changedTouches[0].clientX, e.changedTouches[0].clientY];\n                x = _ref[0];\n                y = _ref[1];\n            } else if (e.type === 'touchstart' || e.type === 'touchmove') {\n                var _ref2 = [e.touches[0].clientX, e.touches[0].clientY];\n                x = _ref2[0];\n                y = _ref2[1];\n            } else {\n                var _ref3 = [e.clientX, e.clientY];\n                x = _ref3[0];\n                y = _ref3[1];\n            }\n            // console.log('getInputCoords(): x, y:', x, y);\n\n            // https://stackoverflow.com/questions/55677/how-do-i-get-the-coordinates-of-a-mouse-click-on-a-canvas-element/18053642#18053642\n            var rect = canvas.getBoundingClientRect();\n            var mx = x - rect.left,\n                my = y - rect.top;\n            // console.log('getInputCoords():', mx, my, canvas.width, canvas.height);\n\n            return [mx, my];\n        }\n    }, {\n        key: 'freeScene',\n        value: function freeScene(scene) {\n            this.freeChildObjects(scene, scene.children);\n        }\n    }, {\n        key: 'freeChildObjects',\n        value: function freeChildObjects(_parent, _children) {\n            while (_children.length > 0) {\n                var ch = _children[0];\n                this.freeChildObjects(ch, ch.children);\n                console.log('@@ freeing: one obj:', ch.name);\n                console.log('@@ freeing obj ' + ch.uuid + ' of ' + _parent.uuid);\n                _parent.remove(ch);\n                this.disposeObject(ch);\n                ch = null;\n            }\n        }\n    }, {\n        key: 'disposeObject',\n        value: function disposeObject(obj) {\n            // https://gist.github.com/j-devel/6d0323264b6a1e47e2ee38bc8647c726\n            if (obj.geometry) obj.geometry.dispose();\n            if (obj.material) this.disposeMaterial(obj.material);\n            if (obj.texture) obj.texture.dispose();\n        }\n    }, {\n        key: 'disposeMaterial',\n        value: function disposeMaterial(mat) {\n            if (mat.map && typeof mat.map.dispose === 'function') mat.map.dispose();\n            if (mat && typeof mat.dispose === 'function') mat.dispose();\n        }\n    }]);\n\n    return Threelet;\n}();\n\nThreelet.Utils = _Utils_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"];\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Threelet);\n\n//# sourceURL=webpack://Threelet/./src/index.js?");

/***/ })

/******/ })["default"];
});